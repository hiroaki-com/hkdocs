---
title: デモ動画をGIF・MP4に変換するツールをGoogle Colabで作りました。
authors: [hk]
tags: [ffmpeg, google-colab, gif, mp4, python, automation, demo-video]
---

import Admonition from '@theme/Admonition';
import ShareButtons from '@site/src/components/ShareButtons';
import GitHubStarLink from '@site/src/components/GitHubStarLink';

<GitHubStarLink repo="hiroaki-com/colab-video-converter" />

開発したツールやプロダクトをGitHubのREADMEやSNSで紹介するとき、デモ動画やGIFを添付すると伝わり方が全然違いますよね。
でも、いざ動画を変換しようとすると「SaaSはサブスクが必要」「ローカルツールは重い」という壁にぶつかります。

そこで、Google Colabの無料環境でffmpegを動かして、画面録画をそのままGIF・MP4に変換できるツールを作りました。ブラウザだけで完結するので、環境構築もソフトのインストールも不要です。

{/* truncate */}

### 作ったもの

<Admonition type="tip" title="🚀 今すぐ試す">
  面倒な環境構築は不要です。以下のリンクからブラウザ上ですぐに実行できます。

  <ul>
    <li style={{ marginBottom: '12px' }}>
      ⚡️ Google Colab で実行する<br/>
      <a href="https://colab.research.google.com/github/hiroaki-com/colab-video-converter/blob/main/make_demo_gif_mp4_ja.ipynb" target="_blank" rel="noopener noreferrer">Make Demo GIF / MP4（日本語版）</a><br/>
      <small style={{ color: 'var(--ifm-color-content-secondary)' }}>クリックして再生ボタンを上から押すだけで動きます。</small>
    </li>
    <li>
      🐙 GitHub でコードを見る<br/>
      <a href="https://github.com/hiroaki-com/colab-video-converter" target="_blank" rel="noopener noreferrer">hiroaki-com/colab-video-converter</a><br/>
      <small style={{ color: 'var(--ifm-color-content-secondary)' }}>ソースコードの確認や、Star / Fork はこちらから。</small>
    </li>
  </ul>
</Admonition>

<div style={{ textAlign: 'center', marginBottom: '24px' }}>
  <img
    src="https://github.com/user-attachments/assets/c7ecf5d8-2225-43d8-9063-f89199389e82"
    alt="Make Demo GIF / MP4 デモ"
    style={{ maxWidth: '100%', borderRadius: '8px' }}
  />
</div>

### なぜこれを作ったのか

GitHubのREADMEにGIFを貼ると、プロジェクトの第一印象がぐっと良くなります。動いている様子が一目でわかるので、読んでもらえる確率も上がる気がしています。

ただ、画面録画をGIFに変換する作業が地味に面倒でした。

SaaSツールはブラウザで完結して便利だけど、品質設定を細かく触ろうとすると有料プランが必要だったりする。ローカルのGUIツールはOSのアップデートのたびに動かなくなったりして管理が煩わしい。

エンジニアとしては、動画変換ツールの使い方をキャッチアップすることは学習の本質ではないし、SaaSにお金を払い続けるのも気が引けます。どうせなら自分で作って、好きなように使い回せるものにしようと思いました。

Google Colabなら無料でffmpegが動かせるし、UIをノートブック上に作れば設定もGUIで完結する。そういう発想でこのツールを作りました。

### 使い方

セルを上から順に実行して、UIを操作するだけです。Pythonのコードを書く必要はありません。

セットアップ（①）でffmpegのインストールが自動で完了したら、動画ファイルをアップロード（②）します。`.mov` `.mp4` `.avi` `.mkv` `.webm` に対応しており、複数ファイルをまとめて選択すれば結合順もドロップダウンで指定できます（③）。

出力形式と品質はラジオボタンで設定します（④）。GIFはあらゆるMarkdownで自動再生・ループが効く反面ファイルサイズが大きく、MP4はフルカラーで小容量ですがプレイヤーが必要です。用途に合わせて選んでください。再生速度も変更でき、1.5〜2.0倍速にすると長い操作デモを短くまとめるのに便利です。

変換実行（⑤）後はノートブック上でプレビューを確認し（⑥）、ローカルへのダウンロードまたはGoogle Driveへの保存を選んで完了です（⑦）。設定を変えて再変換したい場合は⑤のセルだけ再実行すれば済むので、①からやり直す必要はありません。

詳細な品質プリセットや各オプションの説明は [README](https://github.com/hiroaki-com/colab-video-converter) を参照してください。

### 主な機能と技術的なポイント

いくつか工夫した点を紹介します。

- **高品質なGIF変換**

    GIFの変換品質はffmpegのフィルター設定に大きく依存します。このツールでは`palettegen` + `paletteuse`の2パスアプローチを採用しています。

    ```
    [0:v] fps=15,scale=960:-1:flags=lanczos,split [a][b];
    [a] palettegen=max_colors=256:stats_mode=full [p];
    [b][p] paletteuse=dither=floyd_steinberg:diff_mode=rectangle
    ```

    `lanczos`フィルターでリサイズ品質を上げ、`floyd_steinberg`ディザリングで色のグラデーションをなめらかに表現します。カスタム設定では`bayer`ディザリングも選べるので、ファイルサイズと品質のトレードオフを調整できます。

- **ファイルサイズの自動警告**

    GIFが15MBを超えた場合、ノートブックが自動で警告を表示して軽量化の手順を案内します。GitHubのGIFサイズ上限は10MBなので、READMEに貼る前に気づけるようにしています。

- **再生速度変更**

    `setpts`フィルターで速度を変えています。長めの操作録画を1.5〜2.0倍速にするだけで、ファイルサイズもぐっと小さくなります。

    ```python
    speed_filter = f'setpts={1/speed:.4f}*PTS,'  # 1.5倍速なら setpts=0.6667*PTS
    ```

- **複数動画の結合**

    ffmpegのconcatを使い、`-c copy`でコーデックを再エンコードせずにコピーするので結合は高速です。ドロップダウンUIで結合順を自由に指定できます。

### サービス別のサイズ制約

貼り先によって上限が異なるので参考までに。Zennの3MB制限はかなり厳しく、SNS・軽量プリセット（640px / 10fps / 128色）＋1.5倍速の組み合わせが現実的なラインです。

| プラットフォーム | 対応形式 | サイズ上限 |
|:---|:---|:---|
| GitHub README | GIF / MP4 / MOV | 100 MB（動画）/ 10 MB（GIF） |
| Zenn | GIF | 3 MB |
| Qiita | GIF / MP4 | 100 MB |
| X（標準） | MP4 / MOV | 512 MB |
| Slack | GIF / MP4 / MOV 他 | 1 GB |

### まとめ

「変換ツールのサブスクを払いたくない」「ローカルに余計なソフトを入れたくない」、その二つが揃ったので自作しました。

Google Colabのノートブックという形にしたことで、ブラウザさえあればどこでも使えて、設定もGUIで完結します。個人的には、これ以降READMEへのGIF添付が格段に楽になりました。

同じように「デモ動画の変換、毎回面倒だな」と感じている方の参考になれば幸いです。

<ShareButtons />

<GitHubStarLink repo="hiroaki-com/colab-video-converter" />

### 参考文献

- [FFmpeg Documentation](https://ffmpeg.org/documentation.html)
- [FFmpeg Filters: palettegen](https://ffmpeg.org/ffmpeg-filters.html#palettegen)
- [FFmpeg Filters: paletteuse](https://ffmpeg.org/ffmpeg-filters.html#paletteuse)
- [Google Colab](https://colab.research.google.com/)
- [ipywidgets Documentation](https://ipywidgets.readthedocs.io/)
